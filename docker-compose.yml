services:
  crash_test:
    build:
      context: .
      dockerfile: bin/Dockerfile.cutechess-cli
    command: -engine cmd=/engines/princhess -engine cmd=/engines/princhess -each proto=uci tc=1+1 book=/books/gm2001.bin bookdepth=2 -rounds 20 
    volumes:
      - ./target/release/princhess:/engines/princhess
    environment:
      RUST_LOG: warn

  all_versions:
    build:
      context: .
      dockerfile: bin/Dockerfile.cutechess-cli
    command: >
      -engine cmd=/engines/princhess name=princhess-main
      -engine cmd=/engines/princhess-0.6.0 name=princhess-0.6.0
      -engine cmd=/engines/princhess-0.5.1 name=princhess-0.5.1
      -each proto=uci tc=10+0.1 timemargin=1000
            option.SyzygyPath=/syzygy option.Hash=256 option.Threads=1
      -openings file=/books/noob_2moves.epd format=epd order=random
      -games 2 -repeat -rounds 250
      -recover -ratinginterval 1 -concurrency 2
    volumes:
      - ./target/release/princhess:/engines/princhess
      - ./engine/rustic:/engines/rustic
      - ./syzygy:/syzygy:ro
    environment:
      RUST_LOG: warn
